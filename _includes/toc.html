<nav class="toc" aria-label="Table of Contents">
  <details>
    <summary>목차</summary>
    <ul id="toc-list"></ul>
  </details>
</nav>

<script>
document.addEventListener('DOMContentLoaded', function() {
  var tocList = document.getElementById('toc-list');
  var postContent = document.querySelector('.post-content');
  if (!tocList || !postContent) return;

  var headings = postContent.querySelectorAll('h2, h3');
  if (headings.length < 2) {
    document.querySelector('.toc').style.display = 'none';
    return;
  }

  headings.forEach(function(heading, index) {
    if (!heading.id) {
      heading.id = 'heading-' + index;
    }

    var li = document.createElement('li');
    li.className = 'toc-' + heading.tagName.toLowerCase();

    var a = document.createElement('a');
    a.href = '#' + heading.id;
    a.textContent = heading.textContent;
    a.addEventListener('click', function(e) {
      e.preventDefault();
      heading.scrollIntoView({ behavior: 'smooth' });
      history.pushState(null, null, '#' + heading.id);
    });

    li.appendChild(a);
    tocList.appendChild(li);
  });
});
</script>
